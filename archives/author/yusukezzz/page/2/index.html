<!DOCTYPE html>
<html lang="ja" prefix="og: http://ogp.me/ns# fb: http://ogp.me/ns/fb#">
<head>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-3443532-6"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-3443532-6');
</script>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width" />
<meta name="google-site-verification" content="xj9B6ZSemAAH-gdcR6nRiXCivVtsUjdYDovByJsANV8" />
<style type="text/css">
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td,article,aside,canvas,details,embed,figure,figcaption,footer,header,hgroup,menu,nav,output,ruby,section,summary,time,mark,audio,video{font-size:100%;font:inherit;padding:0;border:0;margin:0;vertical-align:baseline}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}table{border-collapse:collapse;border-spacing:0}article,aside,details,figcaption,figure,footer,header,hgroup,menu,nav,section{display:block}

body{font-family:san-serif;font-size:16px;color:#777;line-height:normal;margin:5% 2.5%;background:#fff}
p{margin:20px 0}
a{color:#4e4340}
h1, h2, h3, h4, h5, h6, h1 a, h2 a, h3 a, h4 a, h5 a, h6 a{font-family:helvetica,arial,sans-serif;font-weight:bold;color:#4e4340;text-decoration:none}
h1, h2, h3, h4, h5, h6{margin:20px 0}
h1{font-size:35px}
h2{font-size:30px}
h3{font-size:25px}
h4{font-size:20px}
h5{font-size:18px}
h6{font-size:16px}
strong, dt{font-weight:bold}
em, address, cite, var{font-style:italic}
code{font-family:monospace;color:#657b83;background-color:#fdf6e3;padding:0.2em;font-size:80%;}
pre{overflow-x:auto;white-space:pre-wrap}
hr{height:1px;color:#ccc;border:0 none;margin:30px 0;background-color:#ccc}
.entry-content ul, .comment ul, .entry-content ol, .comment ol{font-family:helvetica,arial,sans-serif;margin-left:20px !important}
.entry-content li:before, .comment-body li:before{content:"- "}
ol li:before{content:"" !important}
#wrapper ol{list-style:decimal inside}
blockquote{padding:0 25px;border:4px solid #4e4340;margin:10px 2%;background:#f6f6f6}
label{display:block}
input, textarea{font-family:arial,sans-serif;font-size:14px;color:#666;padding:1%;border:1px solid #4e4340;outline:none;background:#f6f6f6}
input[type="submit"], input[type="reset"]{cursor:pointer}
#content input[type="submit"], #content input[type="reset"], .button{font-size:18px !important;color:#fff;padding:8px 10px;border:1px solid #4e4340;background-color:#4e4340;opacity:0.8}
#content input[type="submit"]:hover, #content input[type="reset"]:hover, .button:hover{opacity:1}
a img, input[type="image"]{border:0 none}
img, video{max-width:100% !important;height:auto}
#wrapper{max-width:960px;margin:0 auto}
#header, .post{margin-bottom:50px}
#footer{text-align:center;margin-top:150px;clear:both}
#site-title a, #site-title h1 a, #site-title h1{font-family:helvetica,arial,sans-serif;font-size:40px;font-weight:bold;color:#000;text-decoration:none;padding:0;margin:0}
#site-title a:hover, #site-title h1 a:hover{text-decoration:none}
#site-description{font-size:18px;color:#666;margin-top:15px}
.entry-meta{margin-bottom:30px}
.entry-content p{font-size:18px;text-align:justify;text-justify:inter-ideograph;}
.entry-footer, #nav-below{margin-top:30px}
.comment-body{margin:30px 0}
textarea#comment{box-sizing:border-box;width:100%;max-width:350px;height:100px}
#nav-below a{text-decoration:none}
.nav-previous{text-align:left;float:left}
.nav-next{text-align:right;float:right}
.clear{clear:both}
.sticky{}
.bypostauthor{}
.wp-caption{width:100% !important;margin:20px 0}
.alignleft, .aligncenter, .alignright, .aligncenter + .wp-caption-text{text-align:center}
.gallery-caption{border:1px solid #4e4340}
.alignleft{margin:15px 15px 15px 0;float:left}
.alignright{margin:15px 0 15px 15px;float:right}
.aligncenter{display:block;margin:15px auto;clear:both}
.size-thumbnail{margin:5px}
.entry-links, .entry-footer, .post-edit-link{clear:both}
.entry-links, .page .post-edit-link{display:block;margin-top:20px}

@media all and (max-width:480px){body{word-wrap:break-word}}

.screen-reader-text{clip:rect(1px, 1px, 1px, 1px);position:absolute !important}
.form-allowed-tags{display:none}
</style>
<link rel="alternate" type="application/rss+xml" title="Yusukezzz weblog &raquo; フィード" href="https://www.yusukezzz.net/feed" />
<link rel="alternate" type="application/xml" title="sitemap" href="https://www.yusukezzz.net/sitemap.xml" />
<link rel="canonical" href="https://www.yusukezzz.net/">
<title>yusukezzz &#8211; ページ 2 &#8211; yusukezzz weblog</title>

<!-- START - Facebook Open Graph, Google+ and Twitter Card Tags 2.0.8.2 -->
 <!-- Facebook Open Graph -->
  <meta property="og:title" content="yusukezzz"/>
  <meta property="og:url" content="https://www.yusukezzz.net/archives/author/yusukezzz"/>
  <meta property="og:description" content="yusukezzz"/>
 <!-- Google+ / Schema.org -->
 <!-- Twitter Cards -->
 <!-- SEO -->
 <!-- Misc. tags -->
<!-- END - Facebook Open Graph, Google+ and Twitter Card Tags 2.0.8.2 -->

</head>
<body class="archive paged author author-yusukezzz author-1 paged-2 author-paged-2">
<div id="wrapper" class="hfeed">
<header id="header" role="banner">
<section id="branding">
<div id="site-title"><a href="https://www.yusukezzz.net/" title="yusukezzz weblog" rel="home">yusukezzz weblog</a></div>
<div id="site-description"></div>
<div><a href="https://twitter.com/yusukezzz">twitter</a> | <a href="https://github.com/yusukezzz">github</a></div>
<script>
  (function() {
    var cx = '014860011853426368546:m8rb6ucnvy4';
    var gcse = document.createElement('script');
    gcse.type = 'text/javascript';
    gcse.async = true;
    gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
</script>
<gcse:search></gcse:search>
<p style="text-align: center;"><a href="https://www.vultr.com/?ref=7199493"><img src="https://www.vultr.com/media/banner_1.png" width="728" height="90"></a></p>
</section>
</header>
<div id="container"><section id="content" role="main">
<article id="post-92" class="post-92 post type-post status-publish format-standard hentry category-uncategorized tag-android tag-library">
<header>
<h2 class="entry-title"><a href="https://www.yusukezzz.net/archives/92" title="chrome custom tabs の warmup" rel="bookmark">chrome custom tabs の warmup</a></h2> <section class="entry-meta">
<span class="author vcard"><a href="https://www.yusukezzz.net/archives/author/yusukezzz" title="yusukezzz の投稿" rel="author">yusukezzz</a></span>
<span class="meta-sep"> | </span>
<span class="entry-date">2017-10-18</span>
</section>
</header>
<section class="entry-content">
<p>custom tabs を使う際は事前に chrome のプロセスを温めておくことで遷移を高速化出来るのだけど、自前で実装しようと思うと結構面倒くさい<br />
先人の知恵を拝借しようと Github を検索すると下記の実装が見つかった</p>
<p><a href="https://github.com/DreaminginCodeZH/CustomTabsHelper">DreaminginCodeZH/CustomTabsHelper: Custom tabs, made easy&#46;</a></p>
<p><a href="https://github.com/saschpe/android-customtabs">saschpe/android&#45;customtabs: Chrome CustomTabs for Android demystified&#46; Simplifies development and provides higher level classes including fallback in case Chrome isn&#8217;t available on device&#46;</a></p>
<p>CustomTabsHelper は Fragment を使う前提の実装で、今回自分は Fragment を使っていなかったので後者の android-customtabs を採用した<br />
使い方は非常にシンプルで README と example の通りなので省略する</p>
<p>基本的な実装はどちらも同じ、というか下記公式の customtabs 使用例が元になっていて単にアプリ（Fragment）開始時に customtabs の service に接続し、停止時に切断している<br />
<a href="https://github.com/GoogleChrome/custom-tabs-client">GoogleChrome/custom&#45;tabs&#45;client: Chrome custom tabs examples</a></p>
<p>ちょっとしたことだけど非常に反応が良くなるので customtabs を使うならぜひ利用したい</p>
<div class="entry-links"></div>
</section>
<footer class="entry-footer">
<span class="tag-links">タグ: <a href="https://www.yusukezzz.net/archives/tag/android" rel="tag">android</a>, <a href="https://www.yusukezzz.net/archives/tag/library" rel="tag">library</a></span>
</footer> 
</article>
<article id="post-90" class="post-90 post type-post status-publish format-standard hentry category-uncategorized tag-debug tag-java tag-jvisualvm">
<header>
<h2 class="entry-title"><a href="https://www.yusukezzz.net/archives/90" title="jvisualvm でリモート接続" rel="bookmark">jvisualvm でリモート接続</a></h2> <section class="entry-meta">
<span class="author vcard"><a href="https://www.yusukezzz.net/archives/author/yusukezzz" title="yusukezzz の投稿" rel="author">yusukezzz</a></span>
<span class="meta-sep"> | </span>
<span class="entry-date">2017-10-13</span>
</section>
</header>
<section class="entry-content">
<p>jdk をインストールすると付いてくる便利なプロファイラ jvisualvm でリモートサーバの java プロセスに接続する方法についての覚書</p>
<p>jvisualvm でリモート接続する方法は、<br />
jstatd（これも jdk 組み込み）という java プロセスの監視ツールを経由する方法と JMX という仕様を利用する方法の2種類がある<br />
今回はリモートサーバに jdk が入ってなかったので JMX でやる場合</p>
<h3>JMX 起動オプション</h3>
<p>リモートサーバで java アプリを起動する際に以下のオプションを指定しておく（以下は jdk8 の場合）<br />
port は他で使われてなければ何でも良いが、同じ値を指定する<br />
127.0.0.1 は環境に合わせて変える</p>
<pre><code>-Dcom.sun.management.jmxremote.port=3333
-Dcom.sun.management.jmxremote.rmi.port=3333
-Dcom.sun.management.jmxremote.ssl=false
-Dcom.sun.management.jmxremote.authenticate=false
-Djava.rmi.server.hostname=127.0.0.1
</code></pre>
<p>今回接続する際は ssh のポートフォワーディングを利用した<br />
<code>ssh -L 3333:127.0.0.1:3333 user@remote-server</code><br />
などでリモートへの接続を開いておき jvisualvm から localhost:3333 に対して繋ぐ</p>
<div class="entry-links"></div>
</section>
<footer class="entry-footer">
<span class="tag-links">タグ: <a href="https://www.yusukezzz.net/archives/tag/debug" rel="tag">debug</a>, <a href="https://www.yusukezzz.net/archives/tag/java" rel="tag">java</a>, <a href="https://www.yusukezzz.net/archives/tag/jvisualvm" rel="tag">jvisualvm</a></span>
</footer> 
</article>
<article id="post-84" class="post-84 post type-post status-publish format-standard hentry category-uncategorized tag-laravel tag-php">
<header>
<h2 class="entry-title"><a href="https://www.yusukezzz.net/archives/84" title="Laravel で .env の内容が反映されない場合" rel="bookmark">Laravel で .env の内容が反映されない場合</a></h2> <section class="entry-meta">
<span class="author vcard"><a href="https://www.yusukezzz.net/archives/author/yusukezzz" title="yusukezzz の投稿" rel="author">yusukezzz</a></span>
<span class="meta-sep"> | </span>
<span class="entry-date">2017-10-08</span>
</section>
</header>
<section class="entry-content">
<p><a href="https://laravel.com/docs/5.5/configuration#configuration-caching">公式マニュアル</a>にも記載があるが、<br />
Laravel アプリで <code>artisan config:cache</code> を行っていると .env を変更してもファイルの内容が反映されない<br />
また、アプリ内で env ヘルパー関数などから直接環境変数を参照しているとそもそも値が渡っていない<br />
下記実装を見ると分かるが、 config キャッシュ済みの場合はそもそも .env のロード自体がスキップされるため</p>
<p><a href="https://github.com/laravel/framework/blob/bd352a0d2ca93775fce8ef02365b03fc4fb8cbb0/src/Illuminate/Foundation/Bootstrap/LoadEnvironmentVariables.php#L20">framework/LoadEnvironmentVariables&#46;php#L20 at bd352a0d2ca93775fce8ef02365b03fc4fb8cbb0 · laravel/framework</a></p>
<p>解決するには config を cache しない、又は env の値を config ファイルを経由して参照するよう徹底し値の変更ごとに cache し直す</p>
<div class="entry-links"></div>
</section>
<footer class="entry-footer">
<span class="tag-links">タグ: <a href="https://www.yusukezzz.net/archives/tag/laravel" rel="tag">laravel</a>, <a href="https://www.yusukezzz.net/archives/tag/php" rel="tag">php</a></span>
</footer> 
</article>
<article id="post-77" class="post-77 post type-post status-publish format-standard hentry category-uncategorized tag-linux tag-ubuntu tag-ufw tag-vultr">
<header>
<h2 class="entry-title"><a href="https://www.yusukezzz.net/archives/77" title="vultr で ubuntu インストールして最初に行った設定" rel="bookmark">vultr で ubuntu インストールして最初に行った設定</a></h2> <section class="entry-meta">
<span class="author vcard"><a href="https://www.yusukezzz.net/archives/author/yusukezzz" title="yusukezzz の投稿" rel="author">yusukezzz</a></span>
<span class="meta-sep"> | </span>
<span class="entry-date">2017-10-02</span>
</section>
</header>
<section class="entry-content">
<p><a href="https://www.vultr.com/">SSD VPS Servers, Cloud Servers and Cloud Hosting by Vultr &#45; Vultr&#46;com</a> というサービスで ubuntu をインストールした時の記録</p>
<p>2.5ドルのは空きがなかったので5ドルのプランにした<br />
とはいえ東京でメモリ1GBのマシンがこの値段なら十分安い<br />
ちなみに<a href="https://www.vultr.com/?ref=7199493">このリンク</a>から登録してもらうとお互いにクレジットがもらえる（ある程度実際に課金する必要はある）</p>
<p>インストールしたのは ubuntu 16.04<br />
web管理画面から作成を実行し、しばらくしてRUNNINGのステータスになるとアクセス可能になる<br />
IPアドレスと root のパスワードも管理画面で確認可能</p>
<h3>アカウント作成</h3>
<p>最初は root しかいないので作業用アカウントを作成し sudo 出来るグループに追加しておく</p>
<pre><code>adduser yusuke
passwd yusuke
gpasswd -a yusuke admin
</code></pre>
<p>作成したら ssh-copy-id などで公開鍵認証でのログインが出来るようにしておく<br />
必ず鍵認証でアクセスが可能なことを確認しておくこと</p>
<h3>root, パスワードでのログイン禁止設定</h3>
<p><code>sudo vim /etc/ssh/sshd_config</code> して　PermitRootLogin, PasswordAuthentication を no にする<br />
<code>sudo service sshd restart</code> する<br />
この時点でパスワードログイン出来ないことを確認しておくこと</p>
<h3>ファイアウォール設定</h3>
<p>ubuntu では iptables を直接触らずに ufw というコマンドで設定していく<br />
以下では ssh, http, https のみ許可している<br />
参考：<a href="https://qiita.com/yoh-nak/items/46935af3c5c4036e93b3">ufwを使って簡単にファイアウォールを設定する &#45; Qiita</a></p>
<pre><code>sudo ufw default deny
sudo ufw allow 22
sudo ufw allow 80
sudo ufw allow 443
sudo ufw enable
sudo ufw reload
</code></pre>
<h3>aptitude のインストール</h3>
<p>組み込みの apt-get でも十分だが、 aptitude の方が多少便利<br />
具体的には関連パッケージの自動アンインストールをデフォルトでやってくれたりする<br />
（autoremove を付ければ apt-get でも出来る）</p>
<p><code>sudo apt-get install aptitude</code></p>
<p>ついでに upgrade して再起動しておく</p>
<pre><code>sudo aptitude upgrade
sudo reboot
</code></pre>
<h3>怪しいログイン試行をブロック</h3>
<p>denyhosts というサービスをインストールするとログインに失敗したホストを自動的に /etc/hosts.deny に追加してくれる<br />
<code>sudo aptitude install denyhosts</code><br />
設定は<a href="http://d.conma.me/entry/20080126/1201329875">Denyhosts導入メモ &#45; まめ畑</a>などを参考に<br />
<code>sudo service denyhosts restart</code> で設定反映</p>
<h3>タイムゾーンをJSTにする</h3>
<p>デフォルトはUTCなので日本時間に変更する</p>
<pre><code>sudo timedatectl set-timezone Asia/Tokyo
</code></pre>
<p>時刻同期の設定もしておく</p>
<pre><code>sudo aptitude install ntp
sudo vim /etc/ntp.conf
</code></pre>
<p>末尾の方にある server に適当な国内 ntp サーバを設定する<br />
<code>server ntp.nict.jp</code> など<br />
<code>sudo service ntp restart</code> で反映</p>
<div class="entry-links"></div>
</section>
<footer class="entry-footer">
<span class="tag-links">タグ: <a href="https://www.yusukezzz.net/archives/tag/linux" rel="tag">linux</a>, <a href="https://www.yusukezzz.net/archives/tag/ubuntu" rel="tag">ubuntu</a>, <a href="https://www.yusukezzz.net/archives/tag/ufw" rel="tag">ufw</a>, <a href="https://www.yusukezzz.net/archives/tag/vultr" rel="tag">vultr</a></span>
</footer> 
</article>
<article id="post-70" class="post-70 post type-post status-publish format-standard hentry category-uncategorized tag-laravel tag-php">
<header>
<h2 class="entry-title"><a href="https://www.yusukezzz.net/archives/70" title="Laravel の Input 値が空文字列だったら null に変換する機能を無効にする" rel="bookmark">Laravel の Input 値が空文字列だったら null に変換する機能を無効にする</a></h2> <section class="entry-meta">
<span class="author vcard"><a href="https://www.yusukezzz.net/archives/author/yusukezzz" title="yusukezzz の投稿" rel="author">yusukezzz</a></span>
<span class="meta-sep"> | </span>
<span class="entry-date">2017-09-20</span>
</section>
</header>
<section class="entry-content">
<p>Model のフィールドに空文字列を渡しているつもりが mysql 側から NonNull なカラムに Null が渡されたとエラーが返ってきてこの機能の存在に気づいた<br />
middleware は非常に便利だが、自分が実装・追加したわけではない処理に関してはこのような暗黙的な副作用があったりして中々厳しい</p>
<p><a href="https://laravel.com/docs/5.5/requests#input-trimming-and-normalization">HTTP Requests &#45; Laravel &#45; The PHP Framework For Web Artisans</a><br />
ドキュメントにも書かれており、どうやら 5.4 からこの挙動がデフォルトになったようだ<br />
無効にするには <code>App\Http\Kernel</code> クラスにある <code>ConvertEmptyStringsToNull</code> middleware をコメントアウトすれば良い</p>
<div class="entry-links"></div>
</section>
<footer class="entry-footer">
<span class="tag-links">タグ: <a href="https://www.yusukezzz.net/archives/tag/laravel" rel="tag">laravel</a>, <a href="https://www.yusukezzz.net/archives/tag/php" rel="tag">php</a></span>
</footer> 
</article>
<nav id="nav-below" class="navigation" role="navigation">
<div class="nav-previous"><a href="https://www.yusukezzz.net/archives/author/yusukezzz/page/3" ><span class="meta-nav">&larr;</span> 古い方へ</a></div>
<div class="nav-next"><a href="https://www.yusukezzz.net/archives/author/yusukezzz/" >新しい方へ <span class="meta-nav">&rarr;</span></a></div>
</nav>
</section>
</div>
<footer id="footer" role="contentinfo">
<div id="copyright">
&copy; 2018 yusukezzz weblog</div>
</footer>
</div>
<script>
  function loadCss(url) {
    var l = document.createElement('link'); l.rel = 'stylesheet'; l.href = url;
    var h = document.getElementsByTagName('head')[0]; h.parentNode.insertBefore(l, h);
  }
  function loadJs(url, cb) {
    var d = document, t = 'script',
        o = d.createElement(t),
        s = d.getElementsByTagName(t)[0];
    o.async = true;
    o.src = url;
    if (cb) { o.addEventListener('load', function (e) { cb(null, e); }, false); }
    s.parentNode.insertBefore(o, s);
  }
  var cb = function() {
    loadCss('https://www.yusukezzz.net/wp-content/highlightjs/solarized-light.css');
    loadJs('https://www.yusukezzz.net/wp-content/highlightjs/highlight.pack.js', function() {
      hljs.initHighlightingOnLoad();
    });
  };
  var raf = requestAnimationFrame || mozRequestAnimationFrame ||
      webkitRequestAnimationFrame || msRequestAnimationFrame;
  if (raf) raf(cb);
  else window.addEventListener('load', cb);
</script>
</body>
</html>