<!DOCTYPE html>
<html lang="ja" prefix="og: http://ogp.me/ns# fb: http://ogp.me/ns/fb#">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width" />
<meta name="google-site-verification" content="xj9B6ZSemAAH-gdcR6nRiXCivVtsUjdYDovByJsANV8" />
<link rel="stylesheet" type="text/css" href="https://www.yusukezzz.net/wp-content/themes/writer/style.css" />
<link rel="alternate" type="application/rss+xml" title="Yusukezzz weblog &raquo; フィード" href="https://www.yusukezzz.net/feed" />
<link rel="alternate" type="application/xml" title="sitemap" href="https://www.yusukezzz.net/sitemap.xml" />
<link rel="canonical" href="https://www.yusukezzz.net/">
<title>yusukezzz weblog &#8211; ページ 2</title>

<!-- START - Facebook Open Graph, Google+ and Twitter Card Tags 2.0.8.2 -->
 <!-- Facebook Open Graph -->
  <meta property="og:title" content="yusukezzz weblog"/>
  <meta property="og:url" content="https://www.yusukezzz.net"/>
  <meta property="og:description" content="yusukezzz weblog"/>
 <!-- Google+ / Schema.org -->
 <!-- Twitter Cards -->
 <!-- SEO -->
 <!-- Misc. tags -->
<!-- END - Facebook Open Graph, Google+ and Twitter Card Tags 2.0.8.2 -->

<link rel="stylesheet" type="text/css" href="https://www.yusukezzz.net/wp-content/highlightjs/solarized-light.css" />
</head>
<body class="home blog paged paged-2">
<div id="wrapper" class="hfeed">
<header id="header" role="banner">
<section id="branding">
<div id="site-title"><h1><a href="https://www.yusukezzz.net/" title="yusukezzz weblog" rel="home">yusukezzz weblog</a></h1></div>
<div id="site-description"></div>
<div><a href="https://twitter.com/yusukezzz">twitter</a> | <a href="https://github.com/yusukezzz">github</a></div>
<script>
  (function() {
    var cx = '014860011853426368546:m8rb6ucnvy4';
    var gcse = document.createElement('script');
    gcse.type = 'text/javascript';
    gcse.async = true;
    gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
</script>
<gcse:search></gcse:search>
<p style="text-align: center;"><a href="https://www.vultr.com/?ref=7199493"><img src="https://www.vultr.com/media/banner_1.png" width="728" height="90"></a></p>
</section>
</header>
<div id="container"><section id="content" role="main">
<article id="post-77" class="post-77 post type-post status-publish format-standard hentry category-uncategorized tag-linux tag-ubuntu tag-ufw tag-vultr">
<header>
<h2 class="entry-title"><a href="https://www.yusukezzz.net/archives/77" title="vultr で ubuntu インストールして最初に行った設定" rel="bookmark">vultr で ubuntu インストールして最初に行った設定</a></h2> <section class="entry-meta">
<span class="author vcard"><a href="https://www.yusukezzz.net/archives/author/yusukezzz" title="yusukezzz の投稿" rel="author">yusukezzz</a></span>
<span class="meta-sep"> | </span>
<span class="entry-date">2017-10-02</span>
</section>
</header>
<section class="entry-content">
<p><a href="https://www.vultr.com/">SSD VPS Servers, Cloud Servers and Cloud Hosting by Vultr &#45; Vultr&#46;com</a> というサービスで ubuntu をインストールした時の記録</p>
<p>2.5ドルのは空きがなかったので5ドルのプランにした<br />
とはいえ東京でメモリ1GBのマシンがこの値段なら十分安い<br />
ちなみに<a href="https://www.vultr.com/?ref=7199493">このリンク</a>から登録してもらうとお互いにクレジットがもらえる（ある程度実際に課金する必要はある）</p>
<p>インストールしたのは ubuntu 16.04<br />
web管理画面から作成を実行し、しばらくしてRUNNINGのステータスになるとアクセス可能になる<br />
IPアドレスと root のパスワードも管理画面で確認可能</p>
<h3>アカウント作成</h3>
<p>最初は root しかいないので作業用アカウントを作成し sudo 出来るグループに追加しておく</p>
<pre><code>adduser yusuke
passwd yusuke
gpasswd -a yusuke admin
</code></pre>
<p>作成したら ssh-copy-id などで公開鍵認証でのログインが出来るようにしておく<br />
必ず鍵認証でアクセスが可能なことを確認しておくこと</p>
<h3>root, パスワードでのログイン禁止設定</h3>
<p><code>sudo vim /etc/ssh/sshd_config</code> して　PermitRootLogin, PasswordAuthentication を no にする<br />
<code>sudo service sshd restart</code> する<br />
この時点でパスワードログイン出来ないことを確認しておくこと</p>
<h3>ファイアウォール設定</h3>
<p>ubuntu では iptables を直接触らずに ufw というコマンドで設定していく<br />
以下では ssh, http, https のみ許可している<br />
参考：<a href="https://qiita.com/yoh-nak/items/46935af3c5c4036e93b3">ufwを使って簡単にファイアウォールを設定する &#45; Qiita</a></p>
<pre><code>sudo ufw default deny
sudo ufw allow 22
sudo ufw allow 80
sudo ufw allow 443
sudo ufw enable
sudo ufw reload
</code></pre>
<h3>aptitude のインストール</h3>
<p>組み込みの apt-get でも十分だが、 aptitude の方が多少便利<br />
具体的には関連パッケージの自動アンインストールをデフォルトでやってくれたりする<br />
（autoremove を付ければ apt-get でも出来る）</p>
<p><code>sudo apt-get install aptitude</code></p>
<p>ついでに upgrade して再起動しておく</p>
<pre><code>sudo aptitude upgrade
sudo reboot
</code></pre>
<h3>怪しいログイン試行をブロック</h3>
<p>denyhosts というサービスをインストールするとログインに失敗したホストを自動的に /etc/hosts.deny に追加してくれる<br />
<code>sudo aptitude install denyhosts</code><br />
設定は<a href="http://d.conma.me/entry/20080126/1201329875">Denyhosts導入メモ &#45; まめ畑</a>などを参考に<br />
<code>sudo service denyhosts restart</code> で設定反映</p>
<h3>タイムゾーンをJSTにする</h3>
<p>デフォルトはUTCなので日本時間に変更する</p>
<pre><code>sudo timedatectl set-timezone Asia/Tokyo
</code></pre>
<p>時刻同期の設定もしておく</p>
<pre><code>sudo aptitude install ntp
sudo vim /etc/ntp.conf
</code></pre>
<p>末尾の方にある server に適当な国内 ntp サーバを設定する<br />
<code>server ntp.nict.jp</code> など<br />
<code>sudo service ntp restart</code> で反映</p>
<div class="entry-links"></div>
</section>
<footer class="entry-footer">
<span class="tag-links">タグ: <a href="https://www.yusukezzz.net/archives/tag/linux" rel="tag">linux</a>, <a href="https://www.yusukezzz.net/archives/tag/ubuntu" rel="tag">ubuntu</a>, <a href="https://www.yusukezzz.net/archives/tag/ufw" rel="tag">ufw</a>, <a href="https://www.yusukezzz.net/archives/tag/vultr" rel="tag">vultr</a></span>
</footer> 
</article>
<article id="post-70" class="post-70 post type-post status-publish format-standard hentry category-uncategorized tag-laravel tag-php">
<header>
<h2 class="entry-title"><a href="https://www.yusukezzz.net/archives/70" title="Laravel の Input 値が空文字列だったら null に変換する機能を無効にする" rel="bookmark">Laravel の Input 値が空文字列だったら null に変換する機能を無効にする</a></h2> <section class="entry-meta">
<span class="author vcard"><a href="https://www.yusukezzz.net/archives/author/yusukezzz" title="yusukezzz の投稿" rel="author">yusukezzz</a></span>
<span class="meta-sep"> | </span>
<span class="entry-date">2017-09-20</span>
</section>
</header>
<section class="entry-content">
<p>Model のフィールドに空文字列を渡しているつもりが mysql 側から NonNull なカラムに Null が渡されたとエラーが返ってきてこの機能の存在に気づいた<br />
middleware は非常に便利だが、自分が実装・追加したわけではない処理に関してはこのような暗黙的な副作用があったりして中々厳しい</p>
<p><a href="https://laravel.com/docs/5.5/requests#input-trimming-and-normalization">HTTP Requests &#45; Laravel &#45; The PHP Framework For Web Artisans</a><br />
ドキュメントにも書かれており、どうやら 5.4 からこの挙動がデフォルトになったようだ<br />
無効にするには <code>App\Http\Kernel</code> クラスにある <code>ConvertEmptyStringsToNull</code> middleware をコメントアウトすれば良い</p>
<div class="entry-links"></div>
</section>
<footer class="entry-footer">
<span class="tag-links">タグ: <a href="https://www.yusukezzz.net/archives/tag/laravel" rel="tag">laravel</a>, <a href="https://www.yusukezzz.net/archives/tag/php" rel="tag">php</a></span>
</footer> 
</article>
<article id="post-55" class="post-55 post type-post status-publish format-standard hentry category-uncategorized tag-api tag-free tag-image">
<header>
<h2 class="entry-title"><a href="https://www.yusukezzz.net/archives/55" title="無料で使える画像リサイズAPI" rel="bookmark">無料で使える画像リサイズAPI</a></h2> <section class="entry-meta">
<span class="author vcard"><a href="https://www.yusukezzz.net/archives/author/yusukezzz" title="yusukezzz の投稿" rel="author">yusukezzz</a></span>
<span class="meta-sep"> | </span>
<span class="entry-date">2017-05-16</span>
</section>
</header>
<section class="entry-content">
<p>Android アプリで使うために指定した url の画像をリサイズして返してくれるAPIを探したところ、2つ見つけることが出来た<br />
しかもどちらも無料で利用でき、 https にも対応している<br />
登録も API key の取得も要らず、画像の url を書き換えるだけで今すぐ利用出来る</p>
<p> <a href="https://www.yusukezzz.net/archives/55#more-55" class="more-link">続きを読む</a></p>
<div class="entry-links"></div>
</section>
<footer class="entry-footer">
<span class="tag-links">タグ: <a href="https://www.yusukezzz.net/archives/tag/api" rel="tag">api</a>, <a href="https://www.yusukezzz.net/archives/tag/free" rel="tag">free</a>, <a href="https://www.yusukezzz.net/archives/tag/image" rel="tag">image</a></span>
</footer> 
</article>
<article id="post-46" class="post-46 post type-post status-publish format-standard hentry category-uncategorized tag-tmux">
<header>
<h2 class="entry-title"><a href="https://www.yusukezzz.net/archives/46" title="tmux 2.4 で vi 風キーバインドが invalid or unknown command と言われる" rel="bookmark">tmux 2.4 で vi 風キーバインドが invalid or unknown command と言われる</a></h2> <section class="entry-meta">
<span class="author vcard"><a href="https://www.yusukezzz.net/archives/author/yusukezzz" title="yusukezzz の投稿" rel="author">yusukezzz</a></span>
<span class="meta-sep"> | </span>
<span class="entry-date">2017-05-07</span>
</section>
</header>
<section class="entry-content">
<p>起動時に</p>
<p><code>invalid or unknown command: bind-key -t vi-copy v begin-selection</code></p>
<p>などと言われる<br />
どうやら設定の書き方が変わってしまったようだ</p>
<p><a href="https://github.com/tmux/tmux/issues/754">invalid or unknown command: &#96;bind&#45;key &#45;t vi&#45;copy &#46;&#46;&#46;&#46;&#96; · Issue &#35;754 · tmux/tmux</a></p>
<p>ここの下の方に書かれているが、こんな感じにすると直った</p>
<pre><code class="shell">unbind-key -T copy-mode-vi Space     ;   bind-key -T copy-mode-vi v send-keys -X begin-selection
unbind-key -T copy-mode-vi Enter     ;   bind-key -T copy-mode-vi y send-keys -X copy-pipe-and-cancel "reattach-to-user-namespace pbcopy"
unbind-key -T copy-mode-vi C-v       ;   bind-key -T copy-mode-vi C-v send-keys -X rectangle-toggle
unbind-key -T copy-mode-vi [         ;   bind-key -T copy-mode-vi [ send-keys -X begin-selection
unbind-key -T copy-mode-vi ]         ;   bind-key -T copy-mode-vi ] send-keys -X copy-selection
</code></pre>
<div class="entry-links"></div>
</section>
<footer class="entry-footer">
<span class="tag-links">タグ: <a href="https://www.yusukezzz.net/archives/tag/tmux" rel="tag">tmux</a></span>
</footer> 
</article>
<article id="post-22" class="post-22 post type-post status-publish format-standard hentry category-uncategorized tag-php tag-wordpress">
<header>
<h2 class="entry-title"><a href="https://www.yusukezzz.net/archives/22" title="静的サイトジェネレーターを試して wordpress に戻ってみた話" rel="bookmark">静的サイトジェネレーターを試して wordpress に戻ってみた話</a></h2> <section class="entry-meta">
<span class="author vcard"><a href="https://www.yusukezzz.net/archives/author/yusukezzz" title="yusukezzz の投稿" rel="author">yusukezzz</a></span>
<span class="meta-sep"> | </span>
<span class="entry-date">2017-05-05</span>
</section>
</header>
<section class="entry-content">
<p>これまで jekyll, middleman, hugo などの静的サイトジェネレーターを試してきたけど、どうにも CLI で編集・管理する作業に慣れず長続きしなかった</p>
<p>調べてみると GUI を持ったものもいくつか存在したが情報が少なそうだったので結局ローカルPCで wordpress を使って静的サイトを出力するという、本末転倒気味なことを試してみることにした</p>
<p>途中、静的サイトジェネレーターに慣れた方が良かったのでは…？と思わないでもなかったが、一応それなりな環境が出来てしまったので作業の記録を残しておく</p>
<p> <a href="https://www.yusukezzz.net/archives/22#more-22" class="more-link">続きを読む</a></p>
<div class="entry-links"></div>
</section>
<footer class="entry-footer">
<span class="tag-links">タグ: <a href="https://www.yusukezzz.net/archives/tag/php" rel="tag">php</a>, <a href="https://www.yusukezzz.net/archives/tag/wordpress" rel="tag">wordpress</a></span>
</footer> 
</article>
<nav id="nav-below" class="navigation" role="navigation">
<div class="nav-previous"><a href="https://www.yusukezzz.net/page/3" ><span class="meta-nav">&larr;</span> 古い方へ</a></div>
<div class="nav-next"><a href="https://www.yusukezzz.net/" >新しい方へ <span class="meta-nav">&rarr;</span></a></div>
</nav>
</section>
</div>
<footer id="footer" role="contentinfo">
<div id="copyright">
&copy; 2017 yusukezzz weblog</div>
</footer>
</div>
<script src="https://www.yusukezzz.net/wp-content/highlightjs/highlight.pack.js"></script>
<script>hljs.initHighlightingOnLoad();</script>
</body>
</html>