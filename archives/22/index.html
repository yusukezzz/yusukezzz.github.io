<!DOCTYPE html>
<html lang="ja" prefix="og: http://ogp.me/ns# fb: http://ogp.me/ns/fb#">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width" />
<link rel="stylesheet" type="text/css" href="https://www.yusukezzz.net/wp-content/themes/writer/style.css" />
<link rel="alternate" type="application/rss+xml" title="Yusukezzz weblog &raquo; フィード" href="https://www.yusukezzz.net/feed" />
<title>静的サイトジェネレーターを試して wordpress に戻ってみた話 &#8211; yusukezzz weblog</title>
<link rel='prev' title='Hello world' href='https://www.yusukezzz.net/archives/6' />
<link rel='next' title='tmux 2.4 で vi 風キーバインドが invalid or unknown command と言われる' href='https://www.yusukezzz.net/archives/46' />
<link rel="canonical" href="https://www.yusukezzz.net/archives/22" />

<!-- START - Facebook Open Graph, Google+ and Twitter Card Tags 2.0.8.2 -->
 <!-- Facebook Open Graph -->
  <meta property="og:title" content="静的サイトジェネレーターを試して wordpress に戻ってみた話"/>
  <meta property="og:url" content="https://www.yusukezzz.net/archives/22"/>
  <meta property="og:description" content="これまで jekyll, middleman, hugo などの静的サイトジェネレーターを試してきたけど、どうにも CLI で編集・管理する作業に慣れず長続きしなかった調べてみると GUI を持ったものもいくつか存在したが情報が少なそうだったので結局ローカルPCで wordpress を使って静的サイトを出力するという、本末転倒気味なことを試してみることにした途中、静的サイトジェネレーターに慣れた方が良かったのでは…？と思わないでもなかったが、一応それなりな環境が出来てしまったので作業の記録を残しておく注意点当然ながら標準のコメント機能は完全に機能しなくなるwordpr"/>
 <!-- Google+ / Schema.org -->
 <!-- Twitter Cards -->
 <!-- SEO -->
 <!-- Misc. tags -->
<!-- END - Facebook Open Graph, Google+ and Twitter Card Tags 2.0.8.2 -->

</head>
<body class="post-template-default single single-post postid-22 single-format-standard">
<div id="wrapper" class="hfeed">
<header id="header" role="banner">
<section id="branding">
<div id="site-title"><a href="https://www.yusukezzz.net/" title="yusukezzz weblog" rel="home">yusukezzz weblog</a></div>
<div id="site-description"></div>
<div><a href="https://twitter.com/yusukezzz">twitter</a> | <a href="https://github.com/yusukezzz">github</a></div>
<script>
  (function() {
    var cx = '014860011853426368546:m8rb6ucnvy4';
    var gcse = document.createElement('script');
    gcse.type = 'text/javascript';
    gcse.async = true;
    gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
</script>
<gcse:search></gcse:search>
</section>
</header>
<div id="container"><section id="content" role="main">
<article id="post-22" class="post-22 post type-post status-publish format-standard hentry category-uncategorized tag-php tag-wordpress">
<header>
<h1 class="entry-title"><a href="https://www.yusukezzz.net/archives/22" title="静的サイトジェネレーターを試して wordpress に戻ってみた話" rel="bookmark">静的サイトジェネレーターを試して wordpress に戻ってみた話</a></h1> <section class="entry-meta">
<span class="author vcard"><a href="https://www.yusukezzz.net/archives/author/yusukezzz" title="yusukezzz の投稿" rel="author">yusukezzz</a></span>
<span class="meta-sep"> | </span>
<span class="entry-date">2017-05-05</span>
</section>
</header>
<section class="entry-content">
<p>これまで jekyll, middleman, hugo などの静的サイトジェネレーターを試してきたけど、どうにも CLI で編集・管理する作業に慣れず長続きしなかった</p>
<p>調べてみると GUI を持ったものもいくつか存在したが情報が少なそうだったので結局ローカルPCで wordpress を使って静的サイトを出力するという、本末転倒気味なことを試してみることにした</p>
<p>途中、静的サイトジェネレーターに慣れた方が良かったのでは…？と思わないでもなかったが、一応それなりな環境が出来てしまったので作業の記録を残しておく</p>
<p><span id="more-22"></span></p>
<h3>注意点</h3>
<ul>
<li>当然ながら標準のコメント機能は完全に機能しなくなる</li>
<li>wordpress 上で記事を削除しても出力済みの静的ファイルまでは消してくれないので対応が必要</li>
<li>タグやカテゴリにマルチバイト文字を使っていると正しくリンクされない</li>
<li><strong>静的ファイルの出力が非常に遅い（全てのサイト内ページにHTTPリクエストを投げてHTML化しているため）</strong></li>
</ul>
<h3>設定方法</h3>
<p>wordpress の詳細なインストール方法は割愛するが、動けばいいので osx なら標準で apache, php はインストールされているため mysql だけ用意すれば良い<br />
最新で揃えたければ適当に<br />
<code>brew install homebrew/php/php71 nginx mysql</code><br />
など</p>
<p>wordpress 自体の設定はパーマリンク設定を記事ごとに一意のURLを振る形式に必ず変更する<br />
初期設定だとGETパラメータで記事IDを指定するため静的化出来ない</p>
<p>プラグインは <a href="https://ja.wordpress.org/plugins/simply-static/">Simply Static — WordPress プラグイン</a> を入れる<br />
設定は例えばこのサイトならばリンク先に絶対URLで https://www.yusukezzz.net を使用する<br />
出力先は適当なローカルディレクトリで github pages の git リポジトリとして別途設定しておくと楽<br />
これだけでひとまず静的サイト生成出来るので試しに実行してみる</p>
<p>ちなみにこの blog のソースは <a href="https://github.com/yusukezzz/yusukezzz.github.io">yusukezzz/yusukezzz&#46;github&#46;io</a> で見ることが出来る</p>
<h3>ダイエット</h3>
<p>あとは git push するだけだが、恐らく余分なファイルや表示が含まれているので削りたくなるだろう<br />
出力後のファイルに不要なものが含まれていたらプラグイン設定からエクスクルードをよしなに設定しよう</p>
<p>その他以下自分が気になった点と雑な改善方法を列挙しておく<br />
（wordpress の知見がない人はあまりテーマやプラグインを弄らない方が良い）</p>
<ul>
<li>meta タグに不要なのが色々ある
<ul>
<li><a href="https://ja.wordpress.org/plugins/wp-head-cleaner/">wp&#95;head&#40;&#41; cleaner — WordPress プラグイン</a> などで削る</li>
</ul>
</li>
<li>jquery が不要なのに強制的に読み込まれている
<ul>
<li>テーマ上で <code>wp_head();</code> している箇所の前で <code>wp_deregister_script('jquery');</code> する</li>
<li>テーマによっては jquery の存在を前提に jquery-plugin を使っている場合もあるので注意</li>
</ul>
</li>
<li>rss にコメントのフィードURLも含まれている
<ul>
<li><code>wp-includes/feed-rss2.php</code> を適当に編集する</li>
</ul>
</li>
</ul>
<h3>おまけ</h3>
<p>静的ファイル生成時に git push まで自動で行う方法の例（プラグインを弄る）<br />
本当に雑なやり方なので全くおすすめしない</p>
<p>最後に呼ばれる処理である、<br />
<code>/wp-content/plugins/simply-static/includes/tasks/class-ss-wrapup-task.php</code> ファイルの<br />
<code>perform</code> メソッド内で push 操作を行う<br />
例えば<br />
<code>exec("cd /path/to/your.github.io; git add -A; git commit -m \"update\"; git push");</code><br />
など</p>
<div class="entry-links"></div>
</section>
<footer class="entry-footer">
<span class="tag-links">タグ: <a href="https://www.yusukezzz.net/archives/tag/php" rel="tag">php</a>, <a href="https://www.yusukezzz.net/archives/tag/wordpress" rel="tag">wordpress</a></span>
</footer> 
</article>
<div id="disqus_thread"></div>
<script>

/**
*  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
*  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables*/
/*
var disqus_config = function () {
this.page.url = "https://www.yusukezzz.net/archives/22";
this.page.identifier = "22";
};
*/
(function() { // DON'T EDIT BELOW THIS LINE
var d = document, s = d.createElement('script');
s.src = 'https://yusukezzzblog.disqus.com/embed.js';
s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript><footer class="footer">
<nav id="nav-below" class="navigation" role="navigation">
<div class="nav-previous"><a href="https://www.yusukezzz.net/archives/6" rel="prev"><span class="meta-nav">&larr;</span> Hello world</a></div>
<div class="nav-next"><a href="https://www.yusukezzz.net/archives/46" rel="next">tmux 2.4 で vi 風キーバインドが invalid or unknown command と言われる <span class="meta-nav">&rarr;</span></a></div>
</nav>
</footer>
</section>
</div>
<footer id="footer" role="contentinfo">
<div id="copyright">
&copy; 2017 yusukezzz weblog</div>
</footer>
</div>
<script src="https://www.yusukezzz.net/wp-content/highlightjs/highlight.pack.js" defer></script>
<script>
document.addEventListener("DOMContentLoaded", function() {
    hljs.initHighlightingOnLoad();
});
requestAnimationFrame(function() {
    var l = document.createElement('link');
    l.rel = 'stylesheet';
    l.href = 'https://www.yusukezzz.net/wp-content/highlightjs/monokai.css';
    document.head.appendChild(l);
});
</script>
</body>
</html>